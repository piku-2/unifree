# ğŸ“„ **å­¦å†…ãƒ•ãƒªãƒã‚¢ãƒ—ãƒª ä»•æ§˜æ›¸**

---

## 1. **ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆæ¦‚è¦**

### â–  ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

å¤§å­¦å†…ã§ã®ã€Œæ‰‹æ¸¡ã—å‰æã€ã®å®‰å¿ƒãƒ•ãƒªãƒã‚¢ãƒ—ãƒªã€‚
ãƒ¡ãƒ«ã‚«ãƒªã‚ˆã‚Šè»½é‡ãƒ»ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ãƒ»å­¦å†…ãƒ‹ãƒ¼ã‚ºã«æœ€é©åŒ–ã—ãŸ UX ã‚’æä¾›ã™ã‚‹ã€‚

### â–  ä¸»ãªåˆ©ç”¨ã‚·ãƒ¼ãƒ³

- ã‚µãƒ¼ã‚¯ãƒ«ã®å‚™å“ã‚’è­²ã‚ŠãŸã„
- æ–°å…¥ç”Ÿã«ä¸è¦å“ã‚’è²©å£²ã—ãŸã„
- æˆæ¥­ãƒ»ã‚¼ãƒŸã§ä¸è¦ã«ãªã£ãŸæ•™æã‚’å£²ã‚ŠãŸã„
- ã‚¤ãƒ™ãƒ³ãƒˆä¸»å‚¬è€…ãŒé™å®šã‚°ãƒƒã‚ºã‚’è²©å£²ã—ãŸã„

---

## 2. **MVP ç¯„å›²ï¼ˆæœ€å°æ§‹æˆï¼‰**

å†…éƒ¨æ¤œè¨ã‚’è¸ã¾ãˆã¦ **æœ¬å½“ã«å¿…è¦ãªæ©Ÿèƒ½ã ã‘ã«çµã£ãŸ** MVPã€‚

### â–  ãƒ¦ãƒ¼ã‚¶ãƒ¼æ©Ÿèƒ½ï¼ˆä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

| æ©Ÿèƒ½                     | å†…å®¹                                          | å„ªå…ˆåº¦ |
| ------------------------ | --------------------------------------------- | ------ |
| å•†å“ä¸€è¦§                 | ã‚«ãƒ¼ãƒ‰è¡¨ç¤º / ã‚«ãƒ†ã‚´ãƒªçµã‚Šè¾¼ã¿                 | â˜…â˜…â˜…    |
| å•†å“è©³ç´°                 | ç”»åƒãƒ»ä¾¡æ ¼ãƒ»èª¬æ˜ãƒ»å‡ºå“è€…æƒ…å ±                  | â˜…â˜…â˜…    |
| å‡ºå“                     | ã‚¿ã‚¤ãƒˆãƒ« / èª¬æ˜ / ä¾¡æ ¼ / ã‚«ãƒ†ã‚´ãƒª / ç”»åƒ 1 æš | â˜…â˜…â˜…    |
| è³¼å…¥ç”³è«‹ï¼ˆãƒãƒ£ãƒƒãƒˆé–‹å§‹ï¼‰ | å‡ºå“è€…ã¸ DM ã‚’é–‹å§‹ã™ã‚‹                        | â˜…â˜…â˜…    |
| ãƒãƒ£ãƒƒãƒˆ                 | è³¼å…¥æ„æ€è¡¨ç¤ºãƒ»å—ã‘æ¸¡ã—èª¿æ•´                    | â˜…â˜…â˜…    |
| ãƒ­ã‚°ã‚¤ãƒ³                 | Supabase Authï¼ˆãƒ¡ãƒ¼ãƒ«ï¼‰                       | â˜…â˜…â˜…    |
| ãƒã‚¤ãƒšãƒ¼ã‚¸               | å‡ºå“ä¸€è¦§ / è³¼å…¥ç”³è«‹ä¸€è¦§                       | â˜…â˜…     |

### â–  ç®¡ç†è€…æ©Ÿèƒ½ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå‘ã‘ï¼‰

| æ©Ÿèƒ½                       | å†…å®¹                               | å„ªå…ˆåº¦ |
| -------------------------- | ---------------------------------- | ------ |
| ã‚¤ãƒ™ãƒ³ãƒˆå°‚ç”¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | ã‚¤ãƒ™ãƒ³ãƒˆåãƒ»æ—¥ä»˜è¨­å®š               | â˜…â˜…     |
| ç®¡ç†è€…ã«ã‚ˆã‚‹å‡ºå“ç™»éŒ²       | å•†å“ã®ä¸€æ‹¬ç™»éŒ²ï¼ˆä¾‹ï¼šæ–‡åŒ–ç¥­ã‚°ãƒƒã‚ºï¼‰ | â˜…â˜…     |
| ã‚ªãƒ¼ãƒ€ãƒ¼ç®¡ç†               | ç”³è«‹çŠ¶æ³ã‚’ä¸€æ‹¬ç¢ºèª                 | â˜…â˜…     |

â€» ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã¯åˆ¥æ¨©é™ï¼ˆRLS ã§åˆ¶å¾¡ï¼‰

---

## 3. **ç”»é¢æ§‹æˆï¼ˆFigma å‰æï¼‰**

### â–  ç”»é¢ä¸€è¦§ï¼ˆMVPï¼‰

- `/`ï¼šå•†å“ä¸€è¦§
- `/items/[id]`ï¼šå•†å“è©³ç´°
- `/sell`ï¼šå‡ºå“ãƒ•ã‚©ãƒ¼ãƒ 
- `/mypage`ï¼šãƒã‚¤ãƒšãƒ¼ã‚¸
- `/chat/[roomId]`ï¼š1 å¯¾ 1 ãƒãƒ£ãƒƒãƒˆ
- `/admin`ï¼šã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ãƒˆãƒƒãƒ—
- `/admin/items`ï¼šã‚¤ãƒ™ãƒ³ãƒˆå•†å“ç™»éŒ²
- `/admin/orders`ï¼šç”³è«‹ç®¡ç†

---

## 4. **Next.js App Router æ§‹æˆ**

```
app/
 â”œâ”€ layout.tsx
 â”œâ”€ page.tsx                   // å•†å“ä¸€è¦§
 â”œâ”€ items/
 â”‚   â””â”€ [id]/
 â”‚        â””â”€ page.tsx          // å•†å“è©³ç´°
 â”œâ”€ sell/
 â”‚   â””â”€ page.tsx               // å‡ºå“ãƒ•ã‚©ãƒ¼ãƒ 
 â”œâ”€ mypage/
 â”‚   â””â”€ page.tsx               // ãƒã‚¤ãƒšãƒ¼ã‚¸
 â”œâ”€ chat/
 â”‚   â””â”€ [roomId]/
 â”‚        â””â”€ page.tsx          // DMç”»é¢
 â”œâ”€ admin/
 â”‚   â”œâ”€ page.tsx               // ç®¡ç†ãƒˆãƒƒãƒ—
 â”‚   â”œâ”€ items/
 â”‚   â”‚   â””â”€ page.tsx           // ç®¡ç†è€…å‡ºå“ç™»éŒ²
 â”‚   â””â”€ orders/
 â”‚       â””â”€ page.tsx           // ç”³è«‹ç®¡ç†
 â”œâ”€ api/
 â”‚   â””â”€ ... (server actions)
 â””â”€ components/
     â”œâ”€ ui/ (shadcn)
     â””â”€ items/
         â”œâ”€ ItemCard.tsx
         â”œâ”€ ItemList.tsx
         â””â”€ ItemDetail.tsx
```

Server Actions ã‚’æ¨™æº–æ¡ç”¨ã€‚
ç”»åƒã¯ Supabase Storage ã«ç›´æ¥ uploadã€‚

---

## 5. **Supabase Schemaï¼ˆå®Œå…¨ç‰ˆï¼‰**

### â–  `profiles`ï¼ˆAuth æ‹¡å¼µï¼‰

| ã‚«ãƒ©ãƒ      | å‹        | èª¬æ˜                 |
| ---------- | --------- | -------------------- |
| id         | uuid (PK) | auth.users.id ã¨ä¸€è‡´ |
| username   | text      | è¡¨ç¤ºå               |
| created_at | timestamp | è‡ªå‹•                 |

---

### â–  `items`ï¼ˆå•†å“ï¼‰

| ã‚«ãƒ©ãƒ       | å‹          | èª¬æ˜           |            |         |
| ----------- | ----------- | -------------- | ---------- | ------- |
| id          | bigint (PK) | è‡ªå‹•æ¡ç•ª       |            |         |
| owner_id    | uuid        | å‡ºå“è€…         |            |         |
| title       | text        |                |            |         |
| description | text        |                |            |         |
| price       | integer     |                |            |         |
| category    | text        |                |            |         |
| image_url   | text        | Storage ã®ãƒ‘ã‚¹ |            |         |
| created_at  | timestamp   |                |            |         |
| status      | text        | `'selling'     | 'reserved' | 'sold'` |

---

### â–  `chat_rooms`

| ã‚«ãƒ©ãƒ      | å‹          |
| ---------- | ----------- |
| id         | bigint (PK) |
| item_id    | bigint      |
| buyer_id   | uuid        |
| seller_id  | uuid        |
| created_at | timestamp   |

---

### â–  `messages`

| ã‚«ãƒ©ãƒ      | å‹        |
| ---------- | --------- |
| id         | bigint    |
| room_id    | bigint FK |
| sender_id  | uuid      |
| content    | text      |
| created_at | timestamp |

---

### â–  `admin_events`ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ï¼‰

| ã‚«ãƒ©ãƒ       | å‹     |
| ----------- | ------ |
| id          | bigint |
| name        | text   |
| description | text   |
| date        | date   |

---

### â–  RLS ãƒãƒªã‚·ãƒ¼è¨­è¨ˆ

#### items

- **SELECT**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **INSERT**: `owner_id = auth.uid()`
- **UPDATE**: `owner_id = auth.uid()`
- **DELETE**: `owner_id = auth.uid()`

#### messages / chat_rooms

- å½“äº‹è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆbuyer ã¾ãŸã¯ sellerï¼‰

#### admin_events

- `role = 'admin'` ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿æ“ä½œå¯
  â†’ Supabase Auth ã® `app_metadata` ã« role ã‚’å…¥ã‚Œã‚‹é‹ç”¨

---

## 6. **UI / UX è¨­è¨ˆï¼ˆFigma ã§åæ˜ ã™ã¹ãå†…å®¹ï¼‰**

### â–  ãƒˆãƒ¼ãƒ³ & ãƒãƒŠãƒ¼

- å­¦å†…å‘ã‘ï¼šå®‰å¿ƒãƒ»ã‚·ãƒ³ãƒ—ãƒ«ãƒ»è»½ã„
- ã‚«ãƒ©ãƒ¼ï¼šViolet Ã— Neutral
- è§’ä¸¸å¤§ãã‚ã€å½±ã¯è–„ã‚
- 1 ç”»é¢ 6 ã‚«ãƒ¼ãƒ‰ä»¥å†…ï¼ˆæƒ…å ±å¯†åº¦ã‚’ä¸Šã’ãªã„ï¼‰

### â–  ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ  | å½¹å‰²             |
| --------------- | ---------------- |
| ItemCard        | å•†å“ãƒªã‚¹ãƒˆè¡¨ç¤º   |
| ItemDetailPanel | è©³ç´°ã¨ CTA       |
| SellForm        | å‡ºå“ãƒ•ã‚©ãƒ¼ãƒ      |
| ChatBubble      | 1 å¯¾ 1 DM        |
| AdminTable      | ã‚¤ãƒ™ãƒ³ãƒˆç”³è«‹ä¸€è¦§ |

### â–  shadcn/ui ã®æ¡ç”¨ãƒ‘ãƒ¼ãƒ„

- Button
- Input / Textarea
- Card
- Avatar
- Separator
- Tabsï¼ˆadmin ç”»é¢ã§ä½¿ç”¨ï¼‰

---

## 7. **APIï¼ˆServer Actionsï¼‰**

### å‡ºå“

```ts
export async function createItem(formData: FormData) { ... }
```

### å•†å“å–å¾—

```ts
export async function getItems(filters) { ... }
```

### ãƒãƒ£ãƒƒãƒˆé–‹å§‹

```ts
export async function startChat(itemId: number) { ... }
```

### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡

```ts
export async function sendMessage(roomId: number, content: string) { ... }
```

### ç®¡ç†è€…ã‚¤ãƒ™ãƒ³ãƒˆå•†å“ç™»éŒ²

```ts
export async function adminCreateItem(data) { ... }
```

---

## 8. **éæ©Ÿèƒ½è¦ä»¶**

| é …ç›®             | å†…å®¹                                 |
| ---------------- | ------------------------------------ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹   | CSR æ··åœ¨ã€ç”»åƒæœ€é©åŒ–ã€è»½é‡ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£     | RLS / Auth / Storage æ¨©é™            |
| ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ | Supabase ã‚’å‰æã«ã‚·ãƒ³ãƒ—ãƒ«ã™ãã‚‹æ§‹é€   |
| é‹ç”¨             | å‡ºå“è€…é€šå ±æ©Ÿèƒ½ã¯ Phase2              |

---

## 9. **é–‹ç™ºé‹ç”¨ãƒ«ãƒ¼ãƒ«**

### â–  ãƒ–ãƒ©ãƒ³ãƒæ§‹æˆ

- `main`ï¼šæœ¬ç•ª
- `develop`ï¼šé–‹ç™º
- `feature/xxx`ï¼šæ©Ÿèƒ½ã”ã¨

### â–  ã‚³ãƒŸãƒƒãƒˆè¦ç´„ï¼ˆä¾‹ï¼‰

- `feat: add chat ui`
- `fix: item fetch error`
- `refactor: extract ItemCard`

### â–  ãƒ‡ãƒ—ãƒ­ã‚¤

- Vercel â†’ Supabase ã¨æ¥ç¶š
- ç’°å¢ƒå¤‰æ•°ï¼š

  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
